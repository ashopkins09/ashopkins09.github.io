<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Photo-Realistic Bubble Wrap</title>
<style>
  :root {
    --bubble-size: 84px;  /* size in pixels */
    --gap: 18px;          /* spacing between bubbles */
    --rows: 8;            /* adjust to fit photo scale */
    --cols: 10;
  }
  html, body {
    margin:0;
    height:100%;
    overflow:hidden;
    background:#ccc;
  }
  #sheet {
    position:relative;
    width:100%;
    height:100%;
    background: url('https://www.photos-public-domain.com/wp-content/uploads/2018/05/bubble-wrap-texture-2.jpg') center center / cover no-repeat;
  }
  .bubble-grid {
    position:absolute;
    top:50%;
    left:50%;
    transform:translate(-50%, -50%);
    display:grid;
    grid-template-columns: repeat(var(--cols), var(--bubble-size));
    grid-template-rows: repeat(var(--rows), var(--bubble-size));
    gap: var(--gap);
  }
  .bubble {
    width: var(--bubble-size);
    height: var(--bubble-size);
    border-radius:50%;
    position:relative;
    cursor:pointer;
    overflow:hidden;
  }
  .bubble::before {
    /* This layer shows the bubble's unpopped cropped image */
    content:"";
    position:absolute;
    inset:0;
    background-image: inherit; /* set dynamically via JS */
    background-repeat: no-repeat;
    background-size: inherit;
    background-position: inherit;
    border-radius:50%;
    transition: transform 0.2s ease, filter 0.2s ease;
  }
  .bubble.popped::before {
    transform: scaleY(0.8);
    filter: brightness(0.9) contrast(1.1);
  }
  .bubble::after {
    /* Optional subtle crinkle effect when popped */
    content:"";
    position:absolute;
    inset:0;
    border-radius:50%;
    background: transparent;
    pointer-events:none;
    opacity:0;
    transition: opacity 0.2s ease;
  }
  .bubble.popped::after {
    background: repeating-linear-gradient(45deg,
      rgba(0,0,0,0.06) 0px, rgba(0,0,0,0.06) 2px,
      rgba(255,255,255,0.06) 2px, rgba(255,255,255,0.06) 4px);
    opacity:0.3;
  }
</style>
</head>
<body>
  <div id="sheet">
    <div class="bubble-grid" id="grid"></div>
  </div>

<script>
const sheet = document.getElementById('sheet');
const grid = document.getElementById('grid');

const rows = parseInt(getComputedStyle(document.documentElement).getPropertyValue('--rows'));
const cols = parseInt(getComputedStyle(document.documentElement).getPropertyValue('--cols'));
const bubbleSize = parseInt(getComputedStyle(document.documentElement).getPropertyValue('--bubble-size'));
const gap = parseInt(getComputedStyle(document.documentElement).getPropertyValue('--gap'));

let last = null;

const sheetStyles = getComputedStyle(sheet);
const bgUrl = sheetStyles.backgroundImage.slice(5, -2); // remove url("...")

// Weâ€™ll compute each bubble's background-position so it perfectly crops from the photo
function buildGrid(){
  grid.innerHTML = '';
  const totalWidth = cols * bubbleSize + (cols - 1) * gap;
  const totalHeight = rows * bubbleSize + (rows - 1) * gap;

  for(let r=0; r<rows; r++){
    for(let c=0; c<cols; c++){
      const bubble = document.createElement('div');
      bubble.className = 'bubble';

      // Set inherited background size and position to match the main sheet
      bubble.style.backgroundImage = `url('${bgUrl}')`;
      bubble.style.backgroundSize = `${totalWidth}px ${totalHeight}px`;
      bubble.style.backgroundPosition = `-${c * (bubbleSize + gap)}px -${r * (bubbleSize + gap)}px`;

      // Clicking logic
      bubble.addEventListener('click', ()=>{
        if(last && last !== bubble) last.classList.remove('popped');
        bubble.classList.toggle('popped');
        last = bubble.classList.contains('popped') ? bubble : null;
      });

      grid.appendChild(bubble);
    }
  }
}

buildGrid();
</script>
</body>
</html>
