<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Interactive Photo-Style Bubble Wrap</title>
<style>
  :root{
    --bubble-size: 84px;        /* size of each bubble */
    --gap: 18px;                /* spacing between bubbles */
    --rows: 12;                 /* number of visible rows (grid auto) */
    --cols: 14;                 /* number of visible cols (grid auto) */
  }

  /* page layout */
  html,body{
    height:100%;
    margin:0;
    font-family:system-ui,Segoe UI,Roboto,"Helvetica Neue",Arial;
    -webkit-font-smoothing:antialiased;
    background: #f2f6f8;
    color:#111;
  }

  /* wrapper holds the repeating sheet */
  .sheet {
    min-height:100vh;
    display:flex;
    align-items:center;
    justify-content:center;
    padding:48px;
    box-sizing:border-box;
    background-image: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.95), rgba(255,255,255,0.6) 8%, rgba(220,230,235,0.65) 18%),
                      linear-gradient(180deg, rgba(240,246,250,0.65), rgba(230,240,246,0.5));
    /* fallback look. optionally replace with a real photo via the control below */
    background-blend-mode:overlay;
    background-size: cover;
    transition: background-image .35s ease;
  }

  /* controls bar */
  .controls{
    position:fixed;
    left:12px;
    top:12px;
    z-index:50;
    display:flex;
    gap:8px;
    align-items:center;
    background: rgba(255,255,255,0.8);
    padding:8px 10px;
    border-radius:10px;
    box-shadow: 0 6px 18px rgba(20,30,40,0.12);
    backdrop-filter: blur(6px);
    font-size:13px;
  }
  .controls input[type="text"]{
    width:320px;
    padding:6px 8px;
    border-radius:6px;
    border:1px solid rgba(0,0,0,0.08);
    font-size:13px;
  }
  .controls button{ padding:6px 10px; border-radius:6px; border:none; cursor:pointer; }

  /* grid containing bubbles */
  .bubble-grid{
    --full-width: calc(var(--cols) * var(--bubble-size) + (var(--cols) - 1) * var(--gap));
    --full-height: calc(var(--rows) * var(--bubble-size) + (var(--rows) - 1) * var(--gap));
    width: min(95vw, var(--full-width));
    height: min(85vh, var(--full-height));
    display:grid;
    grid-template-columns: repeat(var(--cols), 1fr);
    grid-auto-rows: 1fr;
    gap: var(--gap);
    place-items:center;
    touch-action: manipulation;
    user-select:none;
  }

  /* each bubble element */
  .bubble{
    width: var(--bubble-size);
    height: var(--bubble-size);
    border-radius: 50%;
    position:relative;
    display:inline-block;
    cursor: pointer;
    transition: transform .18s ease, box-shadow .18s ease;
    transform-origin:center;
    -webkit-tap-highlight-color: transparent;
  }

  /* unpopped bubble appearance: glossy, slight refractive shadow */
  .bubble .face{
    position:absolute;
    inset:0;
    border-radius:50%;
    background:
      radial-gradient(circle at 35% 28%, rgba(255,255,255,0.98), rgba(255,255,255,0.6) 10%),
      radial-gradient(circle at 70% 70%, rgba(0,0,0,0.06), rgba(0,0,0,0.02) 30%),
      linear-gradient(180deg, rgba(245,250,255,0.9), rgba(215,230,245,0.8));
    box-shadow:
      0 8px 18px rgba(10,20,30,0.12),
      inset 0 -10px 18px rgba(0,0,0,0.06);
    transition: transform .18s ease, box-shadow .18s ease, background .25s ease;
    display:block;
  }

  /* small bright spec highlight */
  .bubble::after{
    content:"";
    position:absolute;
    width:28%;
    height:28%;
    left:14%;
    top:12%;
    border-radius:50%;
    background: radial-gradient(circle, rgba(255,255,255,1), rgba(255,255,255,0.0) 40%);
    filter: blur(1px);
    pointer-events:none;
  }

  /* slightly raised hover for non-touch */
  .bubble:hover{ transform: translateY(-4px); }
  .bubble:hover .face{ box-shadow: 0 12px 26px rgba(10,20,30,0.14), inset 0 -10px 18px rgba(0,0,0,0.06); }

  /* popped state: flattened, crinkled texture, darker inner-ring */
  .bubble.popped{
    transform: translateY(0) scale(0.98);
  }
  .bubble.popped .face{
    transform: scaleY(0.78); /* flattened while staying round visually */
    background:
      radial-gradient(circle at 40% 34%, rgba(255,255,255,0.9), rgba(255,255,255,0.6) 8%),
      radial-gradient(circle at 70% 70%, rgba(0,0,0,0.08), rgba(0,0,0,0.02) 30%),
      linear-gradient(180deg, rgba(230,240,246,0.95), rgba(200,220,235,0.92));
    box-shadow:
      0 2px 8px rgba(8,12,18,0.14),
      inset 0 -12px 22px rgba(0,0,0,0.14);
    background-size: 200% 200%;
    /* crinkle texture via noise-ish SVG filter (applied below) */
    filter: url(#crinkle);
  }

  /* inner ring (popped rim) */
  .bubble .rim{
    position:absolute;
    inset:6%;
    border-radius:50%;
    pointer-events:none;
    box-shadow: inset 0 6px 10px rgba(0,0,0,0.12), inset 0 -6px 12px rgba(255,255,255,0.06);
    transition: box-shadow .18s ease, opacity .18s ease;
    opacity:0;
  }
  .bubble.popped .rim{ opacity:1; }

  /* small "crease" detail on popped */
  .bubble .crease{
    position:absolute;
    width:60%;
    height:22%;
    left:20%;
    top:54%;
    transform-origin:center;
    pointer-events:none;
    opacity:0;
    transition: opacity .18s ease, transform .2s cubic-bezier(.22,1,.36,1);
    border-radius:8px;
  }
  .bubble.popped .crease{
    opacity:1;
    transform: translateY(-20%) rotate(-6deg) scaleX(1.02);
    background: linear-gradient(90deg, rgba(0,0,0,0.06), rgba(255,255,255,0.06));
    filter: blur(0.4px);
  }

  /* footer text */
  .hint{
    position:fixed;
    right:12px;
    bottom:12px;
    background: rgba(0,0,0,0.6);
    color:#fff;
    padding:8px 10px;
    border-radius:8px;
    font-size:13px;
    z-index:50;
  }

  /* responsive tweak: smaller bubbles on narrow screens */
  @media (max-width:680px){
    :root{ --bubble-size:66px; --gap:12px;}
    .controls input[type="text"]{ width:180px; }
  }

  /* subtle overall page sheen to feel like plastic */
  .sheen {
    position:fixed;
    inset:0;
    pointer-events:none;
    background: radial-gradient(1200px 600px at -10% 30%, rgba(255,255,255,0.06), transparent 12%),
                radial-gradient(1000px 500px at 110% 70%, rgba(255,255,255,0.04), transparent 12%);
    mix-blend-mode: overlay;
  }
</style>
</head>
<body>
  <div class="controls" aria-hidden="false">
    <label style="font-weight:600;margin-right:8px">Background photo URL:</label>
    <input id="bgUrl" type="text" placeholder="Paste a direct image URL (optional)" />
    <button id="applyBtn">Apply</button>
    <button id="resetBtn" title="Return to procedural look">Reset</button>
  </div>

  <div class="sheet" id="sheet">
    <div class="bubble-grid" id="grid" role="grid" aria-label="Interactive bubble-wrap">
      <!-- bubbles will be generated by JS -->
    </div>
  </div>

  <div class="hint" id="hint">Tap / Click a bubble â€” the last one clicked stays popped.</div>
  <div class="sheen"></div>

  <!-- SVG filter for crinkle / noise on popped bubbles -->
  <svg width="0" height="0" style="position:absolute">
    <filter id="crinkle" x="-50%" y="-50%" width="200%" height="200%">
      <!-- subtle turbulence -->
      <feTurbulence type="fractalNoise" baseFrequency="0.9" numOctaves="2" stitchTiles="stitch" result="noise"/>
      <feColorMatrix in="noise" type="saturate" values="0"/>
      <feComponentTransfer>
        <feFuncA type="table" tableValues="0 0.18"/>
      </feComponentTransfer>
      <feBlend in="SourceGraphic" mode="multiply"/>
    </filter>
  </svg>

<script>
/*
  Interactive bubble grid generator + click behavior
  - Single popped bubble at a time (previous unpops when another clicked)
  - Keeps popped bubble round with flattened/crinkled visuals
  - You can supply an image URL to use a real photo background
*/

const grid = document.getElementById('grid');
const sheet = document.getElementById('sheet');
const rows = parseInt(getComputedStyle(document.documentElement).getPropertyValue('--rows')) || 12;
const cols = parseInt(getComputedStyle(document.documentElement).getPropertyValue('--cols')) || 14;

let lastPopped = null;

// Build grid of bubbles
function buildGrid(r,c){
  grid.innerHTML='';
  for(let i=0;i<r*c;i++){
    const cell = document.createElement('div');
    cell.className='bubble';
    cell.setAttribute('role','button');
    cell.setAttribute('aria-label','bubble');
    cell.tabIndex=0;

    // face, rim, crease elements
    const face = document.createElement('span');
    face.className='face';
    const rim = document.createElement('span');
    rim.className='rim';
    const crease = document.createElement('span');
    crease.className='crease';

    cell.appendChild(face);
    cell.appendChild(rim);
    cell.appendChild(crease);

    // click handler
    cell.addEventListener('click', ()=> popBubble(cell), {passive:true});
    // keyboard: enter or space
    cell.addEventListener('keydown', (e)=>{
      if(e.key === 'Enter' || e.key === ' '){
        e.preventDefault();
        popBubble(cell);
      }
    });

    grid.appendChild(cell);
  }
}

// pop logic: only one popped at a time
function popBubble(el){
  if(lastPopped === el) return;     // if same bubble clicked again, do nothing (stays popped)
  if(lastPopped) lastPopped.classList.remove('popped');
  el.classList.add('popped');
  lastPopped = el;
}

// init
buildGrid(rows,cols);

// background photo control
const applyBtn = document.getElementById('applyBtn');
const resetBtn = document.getElementById('resetBtn');
const bgUrl = document.getElementById('bgUrl');

applyBtn.addEventListener('click', ()=>{
  const url = bgUrl.value.trim();
  if(!url){ alert('Paste a direct image URL (ending in .jpg/.png) or drag a hosted image link.'); return; }
  // Validate basic image URL pattern (not long-term guarantee)
  if(!/^https?:\/\/.+\.(jpg|jpeg|png|webp|avif|gif)$/i.test(url)){
    if(!confirm('This URL may not be a direct image link. Try anyway?')) return;
  }
  sheet.style.backgroundImage = `url("${url}")`;
  sheet.style.backgroundSize = 'cover';
  sheet.style.backgroundPosition = 'center';
  sheet.style.backgroundBlendMode = 'normal';
});

resetBtn.addEventListener('click', ()=>{
  sheet.style.backgroundImage = '';
  sheet.style.backgroundSize = '';
  sheet.style.backgroundPosition = '';
  sheet.style.backgroundBlendMode = 'overlay';
  bgUrl.value = '';
});

// quick mobile friendly improvements: prevent accidental double-tap zoom in iOS when tapping many bubbles
document.addEventListener('touchstart', ()=>{}, {passive:true});
</script>
</body>
</html>
