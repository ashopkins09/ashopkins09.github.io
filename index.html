<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Liquid Glass + Bubble Wrap</title>
<style>
  :root{
    --bg:#e6f0ff;
    --glass-bg: rgba(255,255,255,0.12);
    --glass-border: rgba(255,255,255,0.25);
    --accent: #7aa7ff;
    --bubble-size: 48px;
    --gap: 12px;
  }

  html,body{
    height:100%;
    margin:0;
    font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    background: linear-gradient(180deg, #dff0ff 0%, #f7fbff 100%);
  }

  .page{
    min-height:100vh;
    display:grid;
    place-items:center;
    position:relative;
    overflow:hidden;
  }

  #bubble-wrap{
    position: absolute;
    inset: 0;
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(calc(var(--bubble-size) + var(--gap)), 1fr));
    justify-items: center;
    align-content: start;
    gap: var(--gap);
    padding: 40px 20px;
    box-sizing: border-box;
    z-index: 0;
    pointer-events: auto;
  }

  /* Unpopped bubble */
  .bubble {
    width: var(--bubble-size);
    height: var(--bubble-size);
    border-radius: 50%;
    background: radial-gradient(circle at 35% 30%, rgba(255,255,255,0.95) 0 20%,
                                 rgba(255,255,255,0.6) 21% 40%,
                                 rgba(150,180,255,0.22) 41% 60%,
                                 rgba(100,140,255,0.06) 61% 100%);
    box-shadow: 0 8px 14px rgba(20,40,80,0.12),
                inset 0 -6px 18px rgba(0,0,0,0.12);
    transition: all 200ms cubic-bezier(.25,.8,.25,1);
    transform-origin: center center;
    user-select: none;
    cursor: pointer;
  }

  /* Slight stagger for realism */
  .bubble[data-row-offset="1"] { transform: translateX(12px); }

  /* Popped bubble - concave look */
  .bubble.popped {
    background: radial-gradient(circle at 50% 60%, rgba(0,0,0,0.25) 0 25%,
                                 rgba(40,60,100,0.2) 26% 50%,
                                 rgba(200,220,255,0.1) 51% 100%);
    box-shadow: inset 0 4px 8px rgba(0,0,0,0.4),
                inset 0 -2px 4px rgba(255,255,255,0.08);
    transform: scale(1) translateY(0);
    opacity: 0.92;
    pointer-events: none;
  }

  .glass-card{
    position: relative;
    z-index: 3;
    width: min(980px, 92%);
    padding: clamp(18px, 3vw, 36px);
    border-radius: 18px;
    background: linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.06));
    border: 1px solid var(--glass-border);
    box-shadow: 0 8px 40px rgba(10,20,40,0.18);
    backdrop-filter: blur(10px) saturate(1.08);
    -webkit-backdrop-filter: blur(10px) saturate(1.08);
    color: #05305b;
    display:flex;
    gap:20px;
    align-items:center;
    overflow: hidden;
  }

  .glass-card::before{
    content:"";
    position:absolute;
    inset:0;
    pointer-events:none;
    background: linear-gradient(135deg, rgba(255,255,255,0.22) 0%, rgba(255,255,255,0.03) 40%, rgba(255,255,255,0.06) 100%);
    mix-blend-mode: overlay;
  }

  .hero {
    display:flex;
    gap:18px;
    align-items:center;
    width:100%;
  }

  .hero-text{
    flex:1 1 auto;
  }

  h1{
    margin:0 0 8px 0;
    font-size: clamp(20px, 3.6vw, 32px);
    line-height:1.05;
    color: #052b54;
  }

  p.lead{
    margin:0;
    color: rgba(5,45,85,0.85);
  }

  .controls{
    display:flex;
    gap:12px;
    margin-top:14px;
    align-items:center;
  }

  .btn{
    border: none;
    padding:10px 16px;
    border-radius: 10px;
    font-weight:600;
    cursor:pointer;
    background: linear-gradient(180deg, #ffffff 0%, #f1f7ff 100%);
    box-shadow: 0 6px 18px rgba(20,40,80,0.08);
    color: #05407a;
  }
  .btn.primary{
    background: linear-gradient(180deg, #6fb0ff 0%, #3c8df2 100%);
    color: white;
    box-shadow: 0 10px 30px rgba(60,140,242,0.28);
  }

  .credit{
    font-size:12px;
    color: rgba(3,29,56,0.6);
    margin-left:auto;
    white-space:nowrap;
  }

  @media (max-width:720px){
    :root { --bubble-size: 36px; --gap: 10px; }
    .glass-card { padding: 16px; border-radius: 14px; }
  }
</style>
</head>
<body>
  <div class="page" id="page">
    <div id="bubble-wrap"></div>

    <main class="glass-card">
      <div class="hero">
        <div class="hero-text">
          <h1>Liquid Glass Home — Pop to Play</h1>
          <p class="lead">Click or drag anywhere to pop the bubble-wrap background. Double-click to reset.</p>
          <div class="controls">
            <button class="btn primary" id="resetBtn">Refill bubbles</button>
            <button class="btn" id="shuffleBtn">Shuffle layout</button>
            <div class="credit">Made with liquid glass ✨</div>
          </div>
        </div>
      </div>
    </main>
  </div>

<script>
(function () {
  const wrap = document.getElementById('bubble-wrap');
  const resetBtn = document.getElementById('resetBtn');
  const shuffleBtn = document.getElementById('shuffleBtn');
  const page = document.getElementById('page');

  const settings = {
    bubbleSize: parseInt(getComputedStyle(document.documentElement).getPropertyValue('--bubble-size')) || 48,
    gap: parseInt(getComputedStyle(document.documentElement).getPropertyValue('--gap')) || 12,
    popSoundVolume: 0.6
  };

  let audioCtx;
  function ensureAudio(){
    if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    return audioCtx;
  }

  function playPopSound(){
    const ctx = ensureAudio();
    const bufferSize = ctx.sampleRate * 0.05;
    const buffer = ctx.createBuffer(1, bufferSize, ctx.sampleRate);
    const data = buffer.getChannelData(0);
    for (let i=0;i<bufferSize;i++){
      data[i] = (Math.random()*2-1) * (1 - i/bufferSize);
    }
    const noise = ctx.createBufferSource();
    noise.buffer = buffer;

    const band = ctx.createBiquadFilter();
    band.type = 'bandpass';
    band.frequency.value = 1200 + Math.random()*600;

    const gain = ctx.createGain();
    gain.gain.value = settings.popSoundVolume;

    noise.connect(band);
    band.connect(gain);
    gain.connect(ctx.destination);

    const now = ctx.currentTime;
    gain.gain.setValueAtTime(0.0001, now);
    gain.gain.exponentialRampToValueAtTime(settings.popSoundVolume, now + 0.005);
    gain.gain.exponentialRampToValueAtTime(0.0001, now + 0.045);

    noise.start(now);
    noise.stop(now + 0.06);
  }

  function buildGrid(){
    wrap.innerHTML = '';
    const vw = window.innerWidth;
    const vh = window.innerHeight;

    const bubbleTotal = settings.bubbleSize + settings.gap;
    const cols = Math.max(6, Math.floor(vw / bubbleTotal));
    const rows = Math.max(4, Math.ceil(vh / bubbleTotal) + 2);

    wrap.style.gridTemplateColumns = `repeat(${cols}, ${settings.bubbleSize}px)`;

    for (let r = 0; r < rows; r++){
      const offset = (r % 2 === 0) ? 0 : 1;
      for (let c = 0; c < cols; c++){
        const bubble = document.createElement('button');
        bubble.className = 'bubble';
        bubble.setAttribute('type','button');
        bubble.dataset.row = r;
        if (offset) bubble.dataset.rowOffset = "1";
        wrap.appendChild(bubble);
      }
    }
  }

  function popBubble(el){
    if (!el.classList.contains('popped')){
      el.classList.add('popped');
      playPopSound();
    }
  }

  function refill(){
    wrap.querySelectorAll('.bubble').forEach(b => b.classList.remove('popped'));
  }

  function shuffle(){
    const rows = [...new Set(Array.from(wrap.children).map(b => b.dataset.row))];
    rows.forEach(r => {
      const offset = Math.random() > 0.5;
      wrap.querySelectorAll(`.bubble[data-row="${r}"]`).forEach(b => {
        if (offset) b.dataset.rowOffset = "1";
        else b.removeAttribute('data-row-offset');
      });
    });
  }

  let pointerDown = false;
  wrap.addEventListener('pointerdown', e => {
    pointerDown = true;
    if (e.target.classList.contains('bubble')) popBubble(e.target);
  });
  document.addEventListener('pointerup', () => pointerDown = false);
  document.addEventListener('pointermove', e => {
    if (!pointerDown) return;
    const el = document.elementFromPoint(e.clientX, e.clientY);
    if (el && el.classList.contains('bubble')) popBubble(el);
  });

  resetBtn.addEventListener('click', refill);
  shuffleBtn.addEventListener('click', shuffle);
  page.addEventListener('dblclick', refill);
  window.addEventListener('resize', () => buildGrid());

  buildGrid();
})();
</script>
</body>
</html>
